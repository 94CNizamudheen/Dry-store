<%- include ("../../views/partials/user/header.ejs") %>
<style>
    .error-message {
        color: red;
        font-size: 0.9em;
    }
</style>

<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Pages
                <span></span> Register
            </div>
        </div>
    </div>
    <section class="pt-150 pb-150">
        <div class="container">
            <div class="col-lg-6 m-auto">
                <div class="login_wrap widget-taber-content p-30 background-white border-radius-5">
                    <div class="padding_eight_all bg-white">
                        <div class="heading_s1">
                            <h3 class="mb-30">Create an Account</h3>
                            <%if(locals.message && message.length>0){%>
                                <h5 style="color: rgb(198, 27, 27);"><%=message %></h5>
                            <% } %> 
                        </div>
                        <p class="mb-50 font-sm">
                            Your personal data will be used to support your experience throughout this website, to manage access to your account, and for other purposes described in our privacy policy.
                        </p>
                        <form method="post" action="/signUp" id="signInForm" onsubmit="return submitForm();">
                            <div class="form-group">
                                <input type="text" id="name" required name="name" placeholder="Name" onblur="validateName()">
                            </div>
                            <span id="nameError" class="error-message"></span>
                        
                            <div class="form-group">
                                <input type="text" id="email" required name="email" placeholder="Email" onblur="validateEmail()">
                            </div>
                            <span id="emailError" class="error-message"></span>
                        
                            <div class="form-group">
                                <input type="text" id="phone" required name="phone" placeholder="Mobile Number" onblur="validatePhone()">
                            </div>
                            <span id="phoneError" class="error-message"></span>
                        
                            <div class="form-group">
                                <input required id="password" type="password" name="password" placeholder="Password" onblur="validatePassword()">
                            </div>
                            <span id="passwordError" class="error-message"></span>
                        
                            <div class="form-group">
                                <input required id="cPassword" type="password" name="cPassword" placeholder="Confirm password" onblur="validateConfirmPassword()">
                            </div>
                            <span id="cPasswordError" class="error-message"></span>
                        
                            <div class="login_footer form-group">
                                <div class="chek-form">
                                    <div class="custome-checkbox">
                                        <input class="form-check-input" type="checkbox" name="checkbox" id="terms" value="">
                                        <label class="form-check-label" for="terms"><span>I agree to terms &amp; Policy.</span></label>
                                    </div>
                                </div>
                                <span id="termsError" class="error-message"></span>
                                <a href="page-privacy-policy.html"><i class="fi-rs-book-alt mr-5 text-muted"></i>Learn more</a>
                            </div>
                        
                            <div class="form-group">
                                <button type="submit" class="btn btn-fill-out btn-block hover-up" name="register">Submit & Register</button>
                            </div>
                        </form>
                        
                        <div class="divider-text-center mt-15 mb-15">
                            <span> or</span>
                        </div>
                        <ul class="btn-login list_none text-center mb-15">
                            <li><a href="#" class="btn btn-facebook hover-up mb-lg-0 mb-sm-4">Login With Facebook</a></li>
                            <li><a href="/auth/google" class="btn btn-google hover-up">Login With Google</a></li>
                        </ul>
                        <div class="text-muted text-center">Already have an account? <a href="/logIn">Sign in now</a></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<script>
    function validateName(){
        const name = document.getElementById('name').value;
        const nameRegex = /^[A-Za-z\s]+$/;
        if (!nameRegex.test(name)) {
            document.getElementById('nameError').textContent = "Name can only contain letters and spaces";
            return false;
        } else {
            document.getElementById('nameError').textContent = '';
            return true;
        }
    }

    function validateEmail() {
        const email = document.getElementById("email").value;
        const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
        const isValid = emailPattern.test(email);
        document.getElementById("emailError").textContent = isValid ? "" : "Please enter a valid email address";
        return isValid;
    }

    function validatePhone() {
        const phone = document.getElementById("phone").value;
        const phonePattern = /^\d{10}$/;
        const isValid = phonePattern.test(phone);
        document.getElementById("phoneError").textContent = isValid ? "" : "Enter a valid 10-digit phone number";
        return isValid;
    }

    function validatePassword() {
        const password = document.getElementById("password").value;
        const isValid = password.length >= 6;
        document.getElementById("passwordError").textContent = isValid ? "" : "Password must be at least 6 characters long";
        return isValid;
    }

    function validateConfirmPassword() {
        const password = document.getElementById("password").value;
        const cPassword = document.getElementById("cPassword").value;
        const isValid = password === cPassword;
        document.getElementById("cPasswordError").textContent = isValid ? "" : "Passwords do not match";
        return isValid;
    }

    function validateTerms() {
        const terms = document.getElementById("terms").checked;
        document.getElementById("termsError").textContent = terms ? "" : "You must agree to the terms and policy";
        return terms;
    }

    function submitForm() {
        const isValidName = validateName();
        const isValidEmail = validateEmail();
        const isValidPhone = validatePhone();
        const isValidPassword = validatePassword();
        const isValidConfirmPassword = validateConfirmPassword();
        const isValidTerms = validateTerms();

        // Only submit if all fields are valid
        if (isValidName && isValidEmail && isValidPhone && isValidPassword && isValidConfirmPassword && isValidTerms) {
            document.getElementById("signInForm").submit();
        } else {
            alert("Please correct the errors in the form before submitting");
            return false;
        }
    }
</script>

<%- include ("../../views/partials/user/footer.ejs") %>
